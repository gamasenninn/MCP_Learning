# MCPエージェント指示書

効果的なタスク分解と実行のためのコンパクトガイドライン

## ツール選択の黄金律

**既存のものを見る** → データベース／ファイル  
**新しく作る・解く** → Pythonコード実行

### 判断キーワード
- **取得・表示・閲覧・一覧** → データベース／ファイル
- **解く・生成・計算・作る・実装** → execute_python

## ツールの役割

| ツール | 用途 | 代表例 |
|--------|------|---------|
| **データベース** | 既存データの検索・集計 | 「商品一覧を表示」「売上を集計」 |
| **ファイル** | 既存ファイルの読み書き | 「READMEを読む」「結果を保存」 |
| **execute_python** | アルゴリズム・計算・生成 | 「数独を解く」「素数を生成」 |

## 実行パターン

### データベース（3ステップ必須）
```
「商品データを表示」
1. list_tables → 2. get_table_schema(products) → 3. execute_safe_query
```

### ファイル操作
```
「ディレクトリの一覧」 → list_directory
「設定ファイルを読む」 → read_file
「結果をファイルに保存」 → write_file
```

### Python実行（パズル・アルゴリズム系）
```
「数独パズルを解く」 → execute_python（バックトラッキング実装）
「フィボナッチ数列を生成」 → execute_python（数列計算）
「素数を100個表示」 → execute_python（エラトステネス実装）
```

## Pythonコード実行の鉄則

### 必須ルール
1. **必ずprint()で結果表示**
2. **処理の開始・終了を明示**

### 基本テンプレート
```python
print("処理開始...")

# メイン処理
result = your_calculation()

# 結果表示（必須）
print(f"結果: {result}")

print("処理完了")
```

### 良い例
```python
print("処理開始...")
fib = [0, 1]
for i in range(2, 10):
    fib.append(fib[-1] + fib[-2])
print(f"結果: {fib}")
print("処理完了")
```

## エラー対処

| エラー | 対処法 |
|--------|--------|
| "no such table" | list_tablesで確認 |
| "no such column" | get_table_schemaで確認 |
| "File not found" | list_directoryで確認 |
| 構文エラー | コードの構文をチェック |

## パフォーマンスルール

1. **データ制限**: 大量データは`LIMIT 10`
2. **並列実行**: 独立タスクは同時実行
3. **リトライ**: エラー時は最大3回

## 日常会話（ツール不要）

以下は通常の会話で対応：
- 挨拶：「こんにちは」「お疲れさま」
- 応答：「ありがとう」「わかりました」

## プロジェクト固有設定

### 利用可能テーブル
- `products`（商品）、`sales`（売上）、`customers`（顧客）

### カスタマイズ例
```markdown
## 専用ルール
- 金額は日本円表示
- 個人情報は除外表示
```

---
*エージェントの動作をカスタマイズするにはこのファイルを編集してください*